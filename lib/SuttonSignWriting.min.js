/**
* Sutton SignWriting JavaScript Library v1.1.0
* https://github.com/Slevinski/SuttonSignWriting
* Copyright (c) 2007-2016, Stephen E Slevinski Jr
* SuttonSignWriting.min.js is released under the MIT License.
*/
var ssw={key:function(a,b){var c="S[123][0-9a-f]{2}[0-5][0-9a-f]([0-9]{3}x[0-9]{3})?";b&&(c+="("+ssw.regex("-")+")?");var d=a.match(new RegExp(c));return d?d[0]:""},fsw:function(a,b){var c;c=b?ssw.regex("Q-"):ssw.regex("Q");var d=a.match(new RegExp(c));return d?d[0]:""},styling:function(a){var b=a.match(new RegExp(ssw.regex("-")));return b?b[0]:""},mirror:function(a){if(a=ssw.key(a),!ssw.size(a))return"";var g,b=a.slice(0,4),c=a.slice(4,5),d=parseInt(a.slice(5,6),16),e=b+"08",f=b+"18";for(ssw.size(e)||ssw.size(f)?g=8:(0!==d&&4!=d||(g=0),1!=d&&5!=d||(g=6),2!=d&&6!=d||(g=4),3!=d&&7!=d||(g=2)),a="";!ssw.size(a);)d+=g,d>7&&g<8&&(d-=8),d>15&&(d-=16),a=b+c+d.toString(16);return a},fill:function(a,b){if(a=ssw.key(a),!ssw.size(a))return"";b!=-1&&(b=1);var c=a.slice(0,4),d=parseInt(a.slice(4,5)),e=a.slice(5,6);for(a="";!ssw.size(a);)d+=b,d>5&&(d=0),d<0&&(d=5),a=c+d+e;return a},rotate:function(a,b){if(a=ssw.key(a),!ssw.size(a))return"";b!=-1&&(b=1);var c=a.slice(0,4),d=a.slice(4,5),e=parseInt(a.slice(5,6),16);for(a="";!ssw.size(a);)e>7?(e+=b,e>15&&(e=8),e<8&&(e=15),a=c+d+e.toString(16)):(e-=b,e>7&&(e=0),e<0&&(e=7),a=c+d+e);return a},scroll:function(a,b){if(a=ssw.key(a),!ssw.size(a))return"";b!=-1&&(b=1);var c=parseInt(a.slice(1,4),16)+b,d=a.slice(4,5),e=a.slice(5,6),f="S"+c.toString(16)+d+e;return ssw.size(f)?f:a},structure:function(a,b,c){var d={kind:["S100","S37f","S387"],category:["S100","S205","S2f7","S2ff","S36d","S37f","S387"],group:["S100","S10e","S11e","S144","S14c","S186","S1a4","S1ba","S1cd","S1f5","S205","S216","S22a","S255","S265","S288","S2a6","S2b7","S2d5","S2e3","S2f7","S2ff","S30a","S32a","S33b","S359","S36d","S376","S37f","S387"]},e=d[a];if(!e)return b?"is"!=c&&"":[];if(!b&&!c)return e;c||(c="");var f;switch(c){case"is":return e.indexOf(b.slice(0,4))!=-1;case"first":return e[0];case"last":return e.slice(-1)[0];case"prev":f=-2;break;case"":f=-1;break;case"next":f=0;break;default:return""}var g,h=e.length;for(g=0;g<e.length;g+=1)if(parseInt(b.slice(1,4),16)<parseInt(e[g].slice(1,4),16)){h=g;break}return h+=f,h=h<0?0:h>=e.length?e.length-1:h,e[h]},type:function(a){var b,c;switch(a){case"writing":b="100",c="37e";break;case"hand":b="100",c="204";break;case"movement":b="205",c="2f6";break;case"dynamic":b="2f7",c="2fe";break;case"head":case"hcenter":b="2ff",c="36c";break;case"vcenter":b="2ff",c="375";break;case"trunk":b="36d",c="375";break;case"limb":b="376",c="37e";break;case"location":b="37f",c="386";break;case"punctuation":b="387",c="38b";break;default:b="100",c="38b"}return[b,c]},is:function(a,b){if(6==a.length&&!ssw.size(a))return!1;var c=ssw.type(b),d=c[0],e=c[1],f=a.slice(1,4);return parseInt(d,16)<=parseInt(f,16)&&parseInt(e,16)>=parseInt(f,16)},filter:function(a,b){var c=ssw.type(b),d=c[0],e=c[1],f="S"+ssw.range(d,e,1)+"[0-5][0-9a-f][0-9]{3}x[0-9]{3}",g=a.match(new RegExp(f,"g"));return g?g.join(""):""},random:function(a){var b=ssw.type(a),c=b[0],d=b[1],e=Math.floor(Math.random()*(parseInt(d,16)-parseInt(c,16)+1)+parseInt(c,16)),f=Math.floor(6*Math.random()),g=Math.floor(16*Math.random()),h="S"+e.toString(16)+f.toString(16)+g.toString(16);return ssw.size(h)?h:ssw.random(a)},colorize:function(a){var b="000000";return ssw.is(a,"hand")&&(b="0000CC"),ssw.is(a,"movement")&&(b="CC0000"),ssw.is(a,"dynamic")&&(b="FF0099"),ssw.is(a,"head")&&(b="006600"),ssw.is(a,"location")&&(b="884411"),ssw.is(a,"punctuation")&&(b="FF9900"),b},view:function(a,b){if(!ssw.is(a))return"";var c=a.slice(0,4);return b?c+(ssw.size(c+"00")?"0":"1")+"0":c+(ssw.is(c,"hand")&&!ssw.structure("group",c,"is")?"1":"0")+"0"},code:function(a,b){var c,d,e=ssw.fsw(a);if(e){var f="S[123][0-9a-f]{2}[0-5][0-9a-f]",g=e.match(new RegExp(f,"g")),h=g?g.length:0;for(d=0;d<h;d+=1)c=g[d],e=e.replace(c,ssw.code(c,b));return e}if(c=ssw.key(a),!c)return"";var i=262144+96*(parseInt(c.slice(1,4),16)-256)+16*parseInt(c.slice(4,5),16)+parseInt(c.slice(5,6),16)+1;return b?i.toString(16).toUpperCase():String.fromCharCode(55296+(i-65536>>10),56320+(i-65536&1023))},pua:function(a,b){var c,d,e=ssw.fsw(a);if(e){var f="S[123][0-9a-f]{2}[0-5][0-9a-f]",g=e.match(new RegExp(f,"g")),h=g?g.length:0;for(d=0;d<h;d+=1)c=g[d],e=e.replace(c,ssw.pua(c,b));return e}if(c=ssw.key(a),!c)return"";var i=1048576+96*(parseInt(c.slice(1,4),16)-256)+16*parseInt(c.slice(4,5),16)+parseInt(c.slice(5,6),16)+1;return b?i.toString(16).toUpperCase():String.fromCharCode(55296+(i-65536>>10),56320+(i-65536&1023))},uni8:function(a,b){var c,d,e=ssw.fsw(a);if(e){var f="S[123][0-9a-f]{2}[0-5][0-9a-f]",g=e.match(new RegExp(f,"g"));for(d=0;d<g.length;d+=1)c=g[d],e=e.replace(c,ssw.uni8(c,b));return e}if(c=ssw.key(a),!c)return"";var h=parseInt(c.substr(1,3),16)+parseInt("1D700",16),i=b?h.toString(16).toUpperCase():String.fromCharCode(55296+(h-65536>>10),56320+(h-65536&1023)),j=c.substr(4,1);j=parseInt(j,16)+parseInt("1DA9A",16),i+=b?j.toString(16).toUpperCase():String.fromCharCode(55296+(j-65536>>10),56320+(j-65536&1023));var k=c.substr(5,1);return k=parseInt(k,16)+parseInt("1DAA0",16),i+=b?k.toString(16).toUpperCase():String.fromCharCode(55296+(k-65536>>10),56320+(k-65536&1023))},unicode:function(a,b){var c,e=ssw.fsw(a);if(e){var f,g,h;g=parseInt("1DABA",16),e=e.replace("B","B!"),e=e.replace("A",b?g.toString(16).toUpperCase():String.fromCharCode(55296+(g-65536>>10),56320+(g-65536&1023))),e=e.replace("B!",b?(g+1).toString(16).toUpperCase():String.fromCharCode(55296+(g+1-65536>>10),56320+(g+1-65536&1023))),e=e.replace("L",b?(g+2).toString(16).toUpperCase():String.fromCharCode(55296+(g+2-65536>>10),56320+(g+2-65536&1023))),e=e.replace("M",b?(g+3).toString(16).toUpperCase():String.fromCharCode(55296+(g+3-65536>>10),56320+(g+3-65536&1023))),e=e.replace("R",b?(g+4).toString(16).toUpperCase():String.fromCharCode(55296+(g+4-65536>>10),56320+(g+4-65536&1023)));var k,i="[0-9]{3}x[0-9]{3}",j=e.match(new RegExp(i,"g"));for(k=0;k<j.length;k+=1)f=j[k],h=f.replace("x","").split(""),h=h.map(function(a){return a=121520+parseInt(a),b?a.toString(16).toUpperCase():String.fromCharCode(55296+(a-65536>>10),56320+(a-65536&1023))}),e=e.replace(f,h.join(""));i="S[123][0-9a-f]{2}[0-5][0-9a-f]",j=e.match(new RegExp(i,"g"));var l=j?j.length:0;for(k=0;k<l;k+=1)c=j[k],e=e.replace(c,ssw.uni8(c,b));return e}return c=ssw.key(a),ssw.uni8(c,b)},bbox:function(a){var c,d,e,f,g,h,b=/[0-9]{3}x[0-9]{3}/g,i=a.match(b);if(i){var j;for(j=0;j<i.length;j+=1)c=parseInt(i[j].slice(0,3)),d=parseInt(i[j].slice(4,7)),0===j?(e=c,f=c,g=d,h=d):(e=Math.min(e,c),f=Math.max(f,c),g=Math.min(g,d),h=Math.max(h,d));return e==f&&g==h&&(e>500?e=1e3-e:f=1e3-f,g>500?g=1e3-g:h=1e3-h),""+e+" "+f+" "+g+" "+h}return""},displace:function(a,b,c){var d,e,f="[0-9]{3}x[0-9]{3}",g=a.match(new RegExp(f,"g"));if(g){var h;for(h=0;h<g.length;h+=1)d=parseInt(g[h].slice(0,3))+b,e=parseInt(g[h].slice(4,7))+c,a=a.replace(g[h],d+"X"+e);a=a.replace(/X/g,"x")}return a},sizes:{},size:function(a){var b,c,d,e,f=ssw.fsw(a);if(f){var g=ssw.bbox(f);g=g.split(" ");var h=g[0],i=g[1],j=g[2],k=g[3];return e=i-h+"x"+(k-j),"0x0"==e?"":e}var l=ssw.key(a);if(!l)return"";if(ssw.sizes[l])return ssw.sizes[l];var m,n,o=2,p=76*o;ssw.canvaser||(ssw.canvaser=document.createElement("canvas"),ssw.canvaser.width=p,ssw.canvaser.height=p);var q=ssw.canvaser,r=q.getContext("2d");r.clearRect(0,0,p,p),r.font=30*o+"px 'SuttonSignWriting'",r.fillText(ssw.code(l),0,0),m=r.getImageData(0,0,p,p).data;a:for(b=p-1;b>=0;b--)for(c=0;c<p;c+=1)for(d=0;d<4;d+=1)if(n=4*b+4*c*p+d,m[n])break a;var s=b;a:for(c=p-1;c>=0;c--)for(b=0;b<s;b+=1)for(d=0;d<4;d+=1)if(n=4*b+4*c*p+d,m[n])break a;var t=c+1;if(s=""+Math.ceil(s/o),t=""+Math.ceil(t/o),"S19559".indexOf(l)>-1&&(s="19"),"S16d03 S16d0f S16d1f S16d2f S16d23 S16d43 S16d53 S1710d S1711d S1712d S17311 S17321 S17733 S1773f S17743 S1774f S17753 S1775f S16d33 S1713d S1714d S17301 S17329 S1715d".indexOf(l)>-1&&(s="20"),"S24c15 S24c30".indexOf(l)>-1&&(s="22"),"S2903b".indexOf(l)>-1&&(s="23"),"S1d203 S1d233".indexOf(l)>-1&&(s="25"),"S24c15".indexOf(l)>-1&&(s="28"),"S2e629".indexOf(l)>-1&&(s="29"),"S23425".indexOf(l)>-1&&(s="30"),"S2d316".indexOf(l)>-1&&(s="40"),"S2541a".indexOf(l)>-1&&(s="50"),"S1732f S17731 S17741 S17751".indexOf(l)>-1&&(t="20"),"S1412c".indexOf(l)>-1&&(t="21"),"S2a903".indexOf(l)>-1&&(t="31"),"S2b002".indexOf(l)>-1&&(t="36"),e=s+"x"+t,"0x0"==e){var u="S1000815x30 S1000921x30 S1000a30x15 S1000b30x21 S1000c15x30 S1000d21x30 ",v=u.indexOf(l);if(v==-1)e="";else{var w=u.indexOf(" ",v);e=u.slice(v+6,w)}}else ssw.sizes[l]=e;return e},max:function(a,b){var c=ssw.type(b),d=c[0],e=c[1],f="S"+ssw.range(d,e,1)+"[0-5][0-9a-f][0-9]{3}x[0-9]{3}",g=a.match(new RegExp(f,"g"));if(g){var h,i,j,k,m,l="";for(m=0;m<g.length;m+=1)h=g[m].slice(0,6),i=parseInt(g[m].slice(6,9)),j=parseInt(g[m].slice(10,13)),k=ssw.size(h).split("x"),l+=h+i+"x"+j+(i+parseInt(k[0]))+"x"+(j+parseInt(k[1]));return l}return""},norm:function(a){var b,c,d,e,f=ssw.bbox(ssw.max(a,"hcenter")),g=ssw.bbox(ssw.max(a,"vcenter")),h=ssw.bbox(ssw.max(a));if(!h)return"";g?(b=parseInt(g.slice(0,3)),c=parseInt(g.slice(4,7))):(b=parseInt(h.slice(0,3)),c=parseInt(h.slice(4,7))),f?(d=parseInt(f.slice(8,11)),e=parseInt(f.slice(12,15))):(d=parseInt(h.slice(8,11)),e=parseInt(h.slice(12,15)));var i=parseInt((b+c)/2),j=parseInt((d+e)/2),k=500-i,l=500-j,m=a.match(/(A(S[123][0-9a-f]{2}[0-5][0-9a-f])+)?[BLMR]/);return m=m?m[0]:"M",a=m+parseInt(h.slice(4,7))+"x"+parseInt(h.slice(12,15))+ssw.filter(a),ssw.displace(a,k,l)},svg:function(a,b){var e,f,g,h,i,j,c=ssw.fsw(a,!0),d=ssw.styling(c);if(!c){var k=ssw.key(a);if(g=ssw.size(k),!g)return"";c=6==k.length?k+"500x500":k}if(b||(b={}),b.size?b.size=parseFloat(b.size)||"x":b.size=1,b.colorize?b.colorize=!0:b.colorize=!1,b.pad?b.pad=parseInt(b.pad):b.pad=0,b.line?b.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(b.line)?"#"+b.line:b.line:b.line="black",b.fill?b.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(b.fill)?"#"+b.fill:b.fill:b.fill="white",b.back?b.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(b.back)?"#"+b.back:b.back:b.back="",b.E=[],b.F=[],b.copy="uni8"==b.copy?"uni8":"code"==b.copy?"code":"key",d){var l;if(e=d.split("-"),l=e[1].match(/C/),b.colorize=!!l,l=e[1].match(/P[0-9]{2}/),l&&(b.pad=parseInt(l[0].substring(1,l[0].length))),l=e[1].match(/G_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)_/)){var m=l[0].substring(2,l[0].length-1);b.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(m)?"#"+m:m}if(l=e[1].match(/D_([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+))?_/),l&&(h=l[0].substring(2,l[0].length-1).split(","),h[0]&&(b.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(h[0])?"#"+h[0]:h[0]),h[1]&&(b.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(h[1])?"#"+h[1]:h[1])),l=e[1].match(/Z([0-9]+(\.[0-9]+)?|x)/),l&&(b.size=parseFloat(l[0].substring(1,l[0].length))||"x"),e[2]||(e[2]=""),l=e[2].match(/D[0-9]{2}_([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+))?_/g))for(i=0;i<l.length;i+=1)f=parseInt(l[i].substring(1,3)),h=l[i].substring(4,l[i].length-1).split(","),h[0]&&(h[0]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(h[0])?"#"+h[0]:h[0]),h[1]&&(h[1]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(h[1])?"#"+h[1]:h[1]),b.E[f]=h;if(l=e[2].match(/Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?/g))for(i=0;i<l.length;i+=1)f=parseInt(l[i].substring(1,3)),j=l[i].substring(4,l[i].length).split(","),j[0]=parseFloat(j[0]),b.F[f]=j;e.length>3&&(e=e.slice(3).join("-").split("!"),b.class=e[0]?e[0]:"",b.id=e[1]?e[1]:"")}var n,o,p,q=/S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,r={};r.L=-1,r.R=1;var s,v,y,z,A,B,t=500,u=500,w=500,x=500;y=c.charAt(0);var C=ssw.bbox(c);C=C.split(" "),t=parseInt(C[0]),u=parseInt(C[1]),w=parseInt(C[2]),x=parseInt(C[3]),"S"==y&&(500==t&&500==w?(j=g.split("x"),u=500+parseInt(j[0]),x=500+parseInt(j[1])):(u=1e3-t,x=1e3-w)),o=c.match(q),o||(o=[]);var D;for(i=0;i<o.length;i+=1)n=o[i].slice(0,6),s=o[i].slice(6,9),v=o[i].slice(10,13),b.F[i+1]&&(b.F[i+1][1]&&(s=parseInt(s)+parseInt(b.F[i+1][1].slice(0,3))-500,v=parseInt(v)+parseInt(b.F[i+1][1].slice(4,7))-500,t=Math.min(t,s),w=Math.min(w,v)),D=ssw.size(n),D&&(D=D.split("x"),u=Math.max(u,parseInt(s)+b.F[i+1][0]*parseInt(D[0])),x=Math.max(x,parseInt(v)+b.F[i+1][0]*parseInt(D[1])))),v=parseInt(v),p='<g transform="translate('+s+","+v+')">',p+="<text ",p+='class="sym-fill" ',b.css||(p+="style=\"pointer-events:none;font-family:'SuttonSignWritingFill';font-size:"+(b.F[i+1]?30*b.F[i+1][0]:30)+"px;fill:"+(b.E[i+1]&&b.E[i+1][1]?b.E[i+1][1]:b.fill)+";",p+='"'),p+=">",p+=ssw.pua(n),p+="</text>",p+="<text ",p+='class="sym-line" ',b.css||(p+='style="',p+="code"==b.copy?"":"pointer-events:none;",p+="font-family:'SuttonSignWriting';font-size:"+(b.F[i+1]?30*b.F[i+1][0]:30)+"px;fill:"+(b.E[i+1]?b.E[i+1][0]:b.colorize?"#"+ssw.colorize(n):b.line)+";",p+='"'),p+=">",p+=ssw.code(n),p+="</text>",p+="</g>",o[i]=p;t-=b.pad,u+=b.pad,w-=b.pad,x+=b.pad,z=u-t,A=x-w,B=r[y]||0,B=75*B+t-400;var E="<svg ";return b.class&&(E+='class="'+b.class+'" '),b.id&&(E+='id="'+b.id+'" '),E+='version="1.1" xmlns="http://www.w3.org/2000/svg" ',"x"!=b.size&&(E+='width="'+z*b.size+'" height="'+A*b.size+'" '),E+='viewBox="'+t+" "+w+" "+z+" "+A+'">',"code"!=b.copy&&(E+='<text style="font-size:0%;">',E+="pua"==b.copy?ssw.pua(a):"uni8"==b.copy?ssw.uni8(a):"code"==b.copy?ssw.code(a):a,E+="</text>"),b.back&&(E+='  <rect x="'+t+'" y="'+w+'" width="'+z+'" height="'+A+'" style="fill:'+b.back+';" />'),E+=o.join("")+"</svg>",b.laned&&(E='<div style="padding:10px;position:relative;width:'+z+"px;height:"+A+"px;left:"+B+'px;">'+E+"</div>"),E},canvas:function(a,b){var f,g,h,i,j,k,l,c=document.createElement("canvas"),d=ssw.fsw(a,!0),e=ssw.styling(d);if(!d){var m=ssw.key(a);if(h=ssw.size(m),!m)return"";d=6==m.length?m+"500x500":m}if(b||(b={}),b.size?b.size=parseFloat(b.size):b.size=1,b.colorize?b.colorize=!0:b.colorize=!1,b.pad?b.pad=parseInt(b.pad):b.pad=0,b.line?b.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(b.line)?"#"+b.line:b.line:b.line="black",b.fill?b.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(b.fill)?"#"+b.fill:b.fill:b.fill="white",b.back?b.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(b.back)?"#"+b.back:b.back:b.back="",b.E=[],b.F=[],e){var n;if(f=e.split("-"),n=f[1].match(/C/),b.colorize=!!n,n=f[1].match(/P[0-9]{2}/),n&&(b.pad=parseInt(n[0].substring(1,n[0].length))),n=f[1].match(/G_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)_/)){var o=n[0].substring(2,n[0].length-1);b.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(o)?"#"+o:o}if(n=f[1].match(/D_([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+))?_/),n&&(g=n[0].substring(2,n[0].length-1).split(","),g[0]&&(b.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(g[0])?"#"+g[0]:g[0]),g[1]&&(b.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(g[1])?"#"+g[1]:g[1])),n=f[1].match(/Z[0-9]+(\.[0-9]+)?/),n&&(b.size=n[0].substring(1,n[0].length)),f[2]||(f[2]=""),n=f[2].match(/D[0-9]{2}_([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+))?_/g))for(k=0;k<n.length;k+=1)l=parseInt(n[k].substring(1,3)),g=n[k].substring(4,n[k].length-1).split(","),g[0]&&(g[0]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(g[0])?"#"+g[0]:g[0]),g[1]&&(g[1]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(g[1])?"#"+g[1]:g[1]),b.E[l]=g;if(n=f[2].match(/Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?/g))for(k=0;k<n.length;k+=1)l=parseInt(n[k].substring(1,3)),j=n[k].substring(4,n[k].length).split(","),j[0]=parseFloat(j[0]),b.F[l]=j}var p,q,r=/S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,s={};s.L=-1,s.R=1;var t,w,z,A,B,u=500,v=500,x=500,y=500;z=d.charAt(0);var C=ssw.bbox(d);C=C.split(" "),u=parseInt(C[0]),v=parseInt(C[1]),x=parseInt(C[2]),y=parseInt(C[3]),"S"==z&&(500==u&&500==x?(j=h.split("x"),v=500+parseInt(j[0]),y=500+parseInt(j[1])):(v=1e3-u,y=1e3-x)),q=d.match(r);var D=q?q.length:0;for(k=0;k<D;k+=1)p=q[k].slice(0,6),t=q[k].slice(6,9),w=q[k].slice(10,13),b.F[k+1]&&(b.F[k+1][1]&&(t=parseInt(t)+parseInt(b.F[k+1][1].slice(0,3))-500,w=parseInt(w)+parseInt(b.F[k+1][1].slice(4,7))-500,u=Math.min(u,t),x=Math.min(x,w)),i=ssw.size(p),i&&(i=i.split("x"),v=Math.max(v,parseInt(t)+b.F[k+1][0]*parseInt(i[0])),y=Math.max(y,parseInt(w)+b.F[k+1][0]*parseInt(i[1]))));u-=b.pad,v+=b.pad,x-=b.pad,y+=b.pad,A=(v-u)*b.size,B=(y-x)*b.size,c.width=A?A:1,c.height=B?B:1;var E=c.getContext("2d");for(b.back&&(E.rect(0,0,A,B),E.fillStyle=b.back,E.fill()),q=d.match(r),k=0;k<D;k+=1)p=q[k].slice(0,6),t=q[k].slice(6,9),w=q[k].slice(10,13),b.F[k+1]&&(b.F[k+1][1]&&(t=parseInt(t)+parseInt(b.F[k+1][1].slice(0,3))-500,w=parseInt(w)+parseInt(b.F[k+1][1].slice(4,7))-500,u=Math.min(u,t),x=Math.min(x,w)),i=ssw.size(p),i&&(i=i.split("x"),v=Math.max(v,parseInt(t)+b.F[k+1][0]*parseInt(i[0])),y=Math.max(y,parseInt(w)+b.F[k+1][0]*parseInt(i[1])))),E.font=(b.F[k+1]?30*b.size*b.F[k+1][0]:30*b.size)+"px 'SuttonSignWritingFill'",E.fillStyle=b.E[k+1]&&b.E[k+1][1]?b.E[k+1][1]:b.fill,E.fillText(ssw.pua(p),(t-u)*b.size,(w-x)*b.size),E.font=(b.F[k+1]?30*b.size*b.F[k+1][0]:30*b.size)+"px 'SuttonSignWriting'",E.fillStyle=b.E[k+1]?b.E[k+1][0]:b.colorize?"#"+ssw.colorize(p):b.line,E.fillText(ssw.code(p),(t-u)*b.size,(w-x)*b.size);return c},png:function(a,b){if(ssw.fsw(a,!0)||ssw.key(a,!0)){var c=ssw.canvas(a,b),d=c.toDataURL("image/png");return c.remove(),d}return""},query:function(a){return"-"==a?"-":(a=a.match(/Q((A(S[123][0-9a-f]{2}[0-5u][0-9a-fu]|R[123][0-9a-f]{2}t[123][0-9a-f]{2})+)?T)?((R[123][0-9a-f]{2}t[123][0-9a-f]{2}([0-9]{3}x[0-9]{3})?)|(S[123][0-9a-f]{2}[0-5u][0-9a-fu]([0-9]{3}x[0-9]{3})?))*(V[0-9]+)?-?/),a?a[0]:"")},range:function(a,b,c){var d,e,f,g,h,i,j;if(c||(c=""),a=("000"+a).slice(-3),b=""+b,d="",a===b)return a;if(e=[],(a[0]!=b[0]||a[1]!=b[1])&&"0"!=a[2])if(d=a[0]+a[1],c){switch(a[2]){case"f":d+="f";break;case"e":d+="[ef]";break;case"d":case"c":case"b":case"a":d+="["+a[2]+"-f]";break;default:switch(a[2]){case"9":d+="[9a-f]";break;case"8":d+="[89a-f]";break;default:d+="["+a[2]+"-9a-f]"}}f=15-parseInt(a[2],16)+1,a=""+(parseInt(a,16)+f).toString(16),e.push(d)}else{switch(a[2]){case"9":d+="9";break;case"8":d+="[89]";break;default:d+="["+a[2]+"-9]"}f=9-a[2]+1,a=""+(1*a+f),e.push(d)}if(d="",a[0]!=b[0]&&"0"!=a[1])if(c){switch(d=a[0],a[1]){case"f":d+="f";break;case"e":d+="[ef]";break;case"d":case"c":case"b":case"a":d+="["+a[1]+"-f]";break;case"9":d+="[9a-f]";break;case"8":d+="[89a-f]";break;default:d+="["+a[1]+"-9a-f]"}d+="[0-9a-f]",f=15-parseInt(a[1],16)+1,a=""+(parseInt(a,16)+16*f).toString(16),e.push(d)}else{switch(d=a[0],f=9-a[1]+1,a[1]){case"9":d+="9";break;case"8":d+="[89]";break;default:d+="["+a[1]+"-9]"}d+="[0-9]",f=9-a[1]+1,a=""+(1*a+10*f),e.push(d)}if(d="",a[0]!=b[0])if(c){switch(f=parseInt(b[0],16)-parseInt(a[0],16),g=(parseInt(a[0],16)+f-1).toString(16),f){case 1:d=a[0];break;case 2:d="["+a[0]+g+"]";break;default:switch(i=parseInt(a[0],16)>9?"h":"d",j=parseInt(g,16)>9?"h":"d",i+j){case"dd":d+="["+a[0]+"-"+g+"]";break;case"dh":switch(f=9-a[0]){case 0:d+="[9";break;case 1:d+="[89";break;default:d+="["+a[0]+"-9"}switch(g[0]){case"a":d+="a]";break;case"b":d+="ab]";break;default:d+="a-"+g+"]"}break;case"hh":d+="["+a[0]+"-"+g+"]"}}d+="[0-9a-f][0-9a-f]",f=parseInt(b[0],16)-parseInt(a[0],16),a=""+(parseInt(a,16)+256*f).toString(16),e.push(d)}else{switch(f=b[0]-a[0],g=1*a[0]+f-1,f){case 1:d=a[0];break;case 2:d="["+a[0]+g+"]";break;default:d="["+a[0]+"-"+g+"]"}d+="[0-9][0-9]",a=""+(1*a+100*f),e.push(d)}if(d="",a[1]!=b[1])if(c){switch(f=parseInt(b[1],16)-parseInt(a[1],16),g=(parseInt(a[1],16)+f-1).toString(16),d=a[0],f){case 1:d+=a[1];break;case 2:d+="["+a[1]+g+"]";break;default:switch(i=parseInt(a[1],16)>9?"h":"d",j=parseInt(g,16)>9?"h":"d",i+j){case"dd":d+="["+a[1],f>1&&(d+="-"),d+=g+"]";break;case"dh":switch(f=9-a[1]){case 0:d+="[9";break;case 1:d+="[89";break;default:d+="["+a[1]+"-9"}switch(b[1]){case"a":d+="]";break;case"b":d+="a]";break;default:d+="a-"+(parseInt(b[1],16)-1).toString(16)+"]"}break;case"hh":d+="["+a[1],f>1&&(d+="-"),d+=(parseInt(b[1],16)-1).toString(16)+"]"}}d+="[0-9a-f]",f=parseInt(b[1],16)-parseInt(a[1],16),a=""+(parseInt(a,16)+16*f).toString(16),e.push(d)}else{switch(f=b[1]-a[1],g=1*a[1]+f-1,d=a[0],f){case 1:d+=a[1];break;case 2:d+="["+a[1]+g+"]";break;default:d+="["+a[1]+"-"+g+"]"}d+="[0-9]",a=""+(1*a+10*f),e.push(d)}if(d="",a[2]!=b[2])if(c){switch(d=a[0]+a[1],f=parseInt(b[2],16)-parseInt(a[2],16),i=parseInt(a[2],16)>9?"h":"d",j=parseInt(b[2],16)>9?"h":"d",i+j){case"dd":d+="["+a[2],f>1&&(d+="-"),d+=b[2]+"]";break;case"dh":switch(f=9-a[2]){case 0:d+="[9";break;case 1:d+="[89";break;default:d+="["+a[2]+"-9"}switch(b[2]){case"a":d+="a]";break;case"b":d+="ab]";break;default:d+="a-"+b[2]+"]"}break;case"hh":d+="["+a[2],f>1&&(d+="-"),d+=b[2]+"]"}f=parseInt(b[2],16)-parseInt(a[2],16),a=""+(parseInt(a,16)+f).toString(16),e.push(d)}else{switch(f=b[2]-a[2],d=a[0]+a[1],f){case 0:d+=a[2];break;case 1:d+="["+a[2]+b[2]+"]";break;default:d+="["+a[2]+"-"+b[2]+"]"}a=""+(1*a+f),e.push(d)}return d="","0"==a[2]&&"0"==b[2]&&(d=b,e.push(d)),d="",h=e.length,1==h?d=e[0]:(d=e.join(")|("),d="(("+d+"))"),d},regex:function(a,b){if(a=ssw.query(a),!a)return"";var c,d,e,f,g,h,i,j,k,l,m,n,o;b||(b=20);var z,p="S[123][0-9a-f]{2}[0-5][0-9a-f]",q="[0-9]{3}x[0-9]{3}",r="[BLMR]("+q+")("+p+q+")*",s="(A("+p+")+)",t="R[123][0-9a-f]{2}t[123][0-9a-f]{2}",u="S[123][0-9a-f]{2}[0-5u][0-9a-fu]",v="([0-9]{3}x[0-9]{3})?",w="(V[0-9]+)",x="-C?(P[0-9]{2})?(G_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)_)?(D_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)(,([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+))?_)?(Z([0-9]+(.[0-9]+)?|x))?(-(D[0-9]{2}_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)(,([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+))?_)*(Z[0-9]{2},[0-9]+(.[0-9]+)?(,[0-9]{3}x[0-9]{3})?)*)?(--?[_a-zA-Z][_a-zA-Z0-9-]{0,100}( -?[_a-zA-Z][_a-zA-Z0-9-]{0,100})*!([a-zA-Z][_a-zA-Z0-9-]{0,100}!)?)?",y="("+x+")?";if(a=ssw.query(a),!a)return"";if("-"==a)return[x];if("Q"==a)return[s+"?"+r];if("Q-"==a)return[s+"?"+r+y];if("QT"==a)return[s+r];if("QT-"==a)return[s+r+y];var A=[],B=a.indexOf("T")+1;if(B){z="(A";var C=a.slice(0,B);if(a=a.replace(C,""),"QT"==C)z+="("+p+")+)";else if(c=C.match(new RegExp("("+u+"|"+t+")","g"))){var D;for(d=0;d<c.length;d+=1)D=c[d].match(new RegExp(u)),D?(j=D[0].slice(0,4),n=D[0].slice(4,5),j+="u"==n?"[0-5]":n,o=D[0].slice(5,6),j+="u"==o?"[0-9a-f]":o,z+=j):(g=c[d].slice(1,4),h=c[d].slice(5,8),i=ssw.range(g,h,"hex"),j="S"+i+"[0-5][0-9a-f]",z+=j);z+="("+p+")*)"}}if(c=a.match(new RegExp(w,"g")),c&&(b=1*c.toString().slice(1)),e=u+v,c=a.match(new RegExp(e,"g")))for(d=0;d<c.length;d+=1)f=c[d].toString(),m=f.slice(1,4),j="S"+m,n=f.slice(4,5),j+="u"==n?"[0-5]":n,o=f.slice(5,6),j+="u"==o?"[0-9a-f]":o,f.length>6?(k=1*f.slice(6,9),l=1*f.slice(10,13),j+=ssw.range(k-b,k+b),j+="x",j+=ssw.range(l-b,l+b)):j+=q,j=r+j+"("+p+q+")*",j=B?z+j:s+"?"+j,a.indexOf("-")>0&&(j+=y),A.push(j);if(e=t+v,c=a.match(new RegExp(e,"g")))for(d=0;d<c.length;d+=1)f=c[d].toString(),g=f.slice(1,4),h=f.slice(5,8),i=ssw.range(g,h,"hex"),j="S"+i+"[0-5][0-9a-f]",f.length>8?(k=1*f.slice(8,11),l=1*f.slice(12,15),j+=ssw.range(k-b,k+b),j+="x",j+=ssw.range(l-b,l+b)):j+=q,j=r+j+"("+p+q+")*",j=B?z+j:s+"?"+j,a.indexOf("-")>0&&(j+=y),A.push(j);return A.length||(a.indexOf("-")>0&&(j+=y),A.push(z+r)),A},results:function(a,b,c){if(!b)return[];("BLMR".indexOf(c)===-1||c.length>1)&&(c="");var d,e,f,g,h=ssw.regex(a);if(!h)return[];var i;for(i=0;i<h.length;i+=1)d=h[i],e=b.match(new RegExp(d,"g")),b=e?e.join(" "):"";return b?(c&&(b=b.replace(/B/g,c),b=b.replace(/L/g,c),b=b.replace(/M/g,c),b=b.replace(/R/g,c)),f=b.split(" "),g=f.filter(function(a){return!(a in f)&&(f[a]=!0)},{})):g=[],g},lines:function(a,b,c){if(!b)return[];("BLMR".indexOf(c)===-1||c.length>1)&&(c="");var d,e,f,g,h=ssw.regex(a);if(!h)return[];var i;for(i=0;i<h.length;i+=1)d=h[i],d="^"+d+".*",e=b.match(new RegExp(d,"mg")),b=e?e.join("\n"):"";return b?(c&&(b=b.replace(/B/g,c),b=b.replace(/L/g,c),b=b.replace(/M/g,c),b=b.replace(/R/g,c)),f=b.split("\n"),g=f.filter(function(a){return!(a in f)&&(f[a]=!0)},{})):g=[],g},convert:function(a,b){var c,d="";if(ssw.fsw(a)&&/^[Aa]?([Ss]L?)?$/.test(b)){var h,i,e="S[123][0-9a-f]{2}",f=e+"[0-5][0-9a-f]",g="[0-9]{3}x[0-9]{3}";if((b.indexOf("A")>-1||b.indexOf("a")>-1)&&(h=a.match(new RegExp("A("+f+")*","g"))))if(i=h[0],b.indexOf("A")>-1)d+=i+"T";else{for(h=i.match(new RegExp(e,"g")),d+="A",c=0;c<h.length;c+=1)d+=h[c]+"uu";d+="T"}if((b.indexOf("S")>-1||b.indexOf("s")>-1)&&(h=a.match(new RegExp(f+g,"g"))))for(c=0;c<h.length;c+=1)d+=b.indexOf("S")>-1?h[c].slice(0,6):h[c].slice(0,4)+"uu",b.indexOf("L")>-1&&(d+=h[c].slice(6,13))}return d?"Q"+d:""},signtext:function(a){var b=ssw.regex("Q");b=b[0],b="("+b+"|S3[0-9a-f]{2}[0-5][0-9a-f]([0-9]{3}x[0-9]{3}))("+ssw.regex("-")[0]+")?";var c=a.match(new RegExp(b,"mg"));return c?c:[]},paragraph:function(a){var b=ssw.signtext(a).map(function(a){var b=a.match(/Z([0-9]+(\.[0-9]+)?)/);b=b?parseFloat(b[1]):1;var c=ssw.bbox(a).split(" "),d=(c[1]-c[0])*b,e=(c[3]-c[2])*b,f=(1e3-c[0]-c[1])*b;f+=2,a.indexOf("L")>-1&&(f+=150),a.indexOf("R")>-1&&(f-=150);var g="width: "+d+"px;height: "+e+"px;";return f>0?g+="margin-right: "+f+"px;":f<0&&(f=-f,g+="border-left: "+f+"px solid transparent;"),'<div class="sign" style="'+g+'">'+ssw.svg(a)+"</div>"});return'<span class="outside"><span class="middle"><span class="inside">'+b.join("")+"</span></span></span>"}};