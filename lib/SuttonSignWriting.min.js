/**
* Sutton SignWriting JavaScript Library v1.3.2
* https://github.com/Slevinski/SuttonSignWriting
* Copyright (c) 2007-2017, Stephen E Slevinski Jr
* SuttonSignWriting.min.js is released under the MIT License.
*/
var ssw={key:function(e,a){if(!e)return"";var s="S[123][0-9a-f]{2}[0-5][0-9a-f]([0-9]{3}x[0-9]{3})?";a&&(s+="("+ssw.regex("-")+")?");var r=e.match(new RegExp(s));return r?r[0]:""},fsw:function(e,a){if(!e)return"";var s;s=a?ssw.regex("Q-"):ssw.regex("Q");var r=e.match(new RegExp(s));return r?r[0]:""},styling:function(e){if(!e)return"";var a=e.match(new RegExp(ssw.regex("-")));return a?a[0]:""},mirror:function(e){if(e=ssw.key(e),!ssw.size(e))return"";var a,s=e.slice(0,4),r=e.slice(4,5),t=parseInt(e.slice(5,6),16),n=s+"08",i=s+"18";for(ssw.size(n)||ssw.size(i)?a=8:(0!==t&&4!=t||(a=0),1!=t&&5!=t||(a=6),2!=t&&6!=t||(a=4),3!=t&&7!=t||(a=2)),e="";!ssw.size(e);)(t+=a)>7&&a<8&&(t-=8),t>15&&(t-=16),e=s+r+t.toString(16);return e},fill:function(e,a){if(e=ssw.key(e),!ssw.size(e))return"";-1!=a&&(a=1);var s=e.slice(0,4),r=parseInt(e.slice(4,5)),t=e.slice(5,6);for(e="";!ssw.size(e);)(r+=a)>5&&(r=0),r<0&&(r=5),e=s+r+t;return e},rotate:function(e,a){if(e=ssw.key(e),!ssw.size(e))return"";-1!=a&&(a=1);var s=e.slice(0,4),r=e.slice(4,5),t=parseInt(e.slice(5,6),16);for(e="";!ssw.size(e);)t>7?((t+=a)>15&&(t=8),t<8&&(t=15),e=s+r+t.toString(16)):((t-=a)>7&&(t=0),t<0&&(t=7),e=s+r+t);return e},scroll:function(e,a){if(e=ssw.key(e),!ssw.size(e))return"";-1!=a&&(a=1);var s=parseInt(e.slice(1,4),16)+a,r=e.slice(4,5),t=e.slice(5,6),n="S"+s.toString(16)+r+t;return ssw.size(n)?n:e},structure:function(e,a,s){var r={kind:["S100","S37f","S387"],category:["S100","S205","S2f7","S2ff","S36d","S37f","S387"],group:["S100","S10e","S11e","S144","S14c","S186","S1a4","S1ba","S1cd","S1f5","S205","S216","S22a","S255","S265","S288","S2a6","S2b7","S2d5","S2e3","S2f7","S2ff","S30a","S32a","S33b","S359","S36d","S376","S37f","S387"]}[e];if(!r)return a?"is"!=s&&"":[];if(!a&&!s)return r;s||(s="");var t;switch(s){case"is":return-1!=r.indexOf(a.slice(0,4));case"first":return r[0];case"last":return r.slice(-1)[0];case"prev":t=-2;break;case"":t=-1;break;case"next":t=0;break;default:return""}var n,i=r.length;for(n=0;n<r.length;n+=1)if(parseInt(a.slice(1,4),16)<parseInt(r[n].slice(1,4),16)){i=n;break}return i+=t,i=i<0?0:i>=r.length?r.length-1:i,r[i]},type:function(e){var a,s;switch(e){case"writing":a="100",s="37e";break;case"hand":a="100",s="204";break;case"movement":a="205",s="2f6";break;case"dynamic":a="2f7",s="2fe";break;case"head":case"hcenter":a="2ff",s="36c";break;case"vcenter":a="2ff",s="375";break;case"trunk":a="36d",s="375";break;case"limb":a="376",s="37e";break;case"location":a="37f",s="386";break;case"punctuation":a="387",s="38b";break;default:a="100",s="38b"}return[a,s]},is:function(e,a){if(6==e.length&&!ssw.size(e))return!1;var s=ssw.type(a),r=s[0],t=s[1],n=e.slice(1,4);return parseInt(r,16)<=parseInt(n,16)&&parseInt(t,16)>=parseInt(n,16)},filter:function(e,a){var s=ssw.type(a),r=s[0],t=s[1],n="S"+ssw.range(r,t,1)+"[0-5][0-9a-f][0-9]{3}x[0-9]{3}",i=e.match(new RegExp(n,"g"));return i?i.join(""):""},random:function(e){var a=ssw.type(e),s=a[0],r=a[1],t=Math.floor(Math.random()*(parseInt(r,16)-parseInt(s,16)+1)+parseInt(s,16)),n=Math.floor(6*Math.random()),i=Math.floor(16*Math.random()),f="S"+t.toString(16)+n.toString(16)+i.toString(16);return ssw.size(f)?f:ssw.random(e)},colorize:function(e){var a="000000";return ssw.is(e,"hand")&&(a="0000CC"),ssw.is(e,"movement")&&(a="CC0000"),ssw.is(e,"dynamic")&&(a="FF0099"),ssw.is(e,"head")&&(a="006600"),ssw.is(e,"location")&&(a="884411"),ssw.is(e,"punctuation")&&(a="FF9900"),a},view:function(e,a){if(!ssw.is(e))return"";var s=e.slice(0,4);return a?s+(ssw.size(s+"00")?"0":"1")+"0":s+(ssw.is(s,"hand")&&!ssw.structure("group",s,"is")?"1":"0")+"0"},uni:function(e,a,s){var r,t,n=ssw.fsw(e);if(n){var i=n.match(new RegExp("S[123][0-9a-f]{2}[0-5][0-9a-f]","g")),f=i?i.length:0;for(t=0;t<f;t+=1)r=i[t],n=n.replace(r,ssw.uni(r,a,s));return n}if(!(r=ssw.key(e)))return"";var c=parseInt(a+"0000",16)+96*(parseInt(r.slice(1,4),16)-256)+16*parseInt(r.slice(4,5),16)+parseInt(r.slice(5,6),16)+1;return r=r.replace(r.substr(0,6),s?c.toString(16).toUpperCase():String.fromCharCode(55296+(c-65536>>10),56320+(c-65536&1023)))},code:function(e,a){return ssw.uni(e,"4",a)},pua:function(e,a){return ssw.uni(e,"10",a)},uni8:function(e,a){var s,r,t=ssw.fsw(e);if(t){var n=t.match(new RegExp("S[123][0-9a-f]{2}[0-5][0-9a-f]","g"));for(r=0;r<n.length;r+=1)s=n[r],t=t.replace(s,ssw.uni8(s,a));return t}if(!(s=ssw.key(e)))return"";var i=parseInt(s.substr(1,3),16)+parseInt("1D700",16),f=a?i.toString(16).toUpperCase():String.fromCharCode(55296+(i-65536>>10),56320+(i-65536&1023)),c=s.substr(4,1);c=parseInt(c,16)+parseInt("1DA9A",16),f+=a?c.toString(16).toUpperCase():String.fromCharCode(55296+(c-65536>>10),56320+(c-65536&1023));var l=s.substr(5,1);return l=parseInt(l,16)+parseInt("1DAA0",16),f+=a?l.toString(16).toUpperCase():String.fromCharCode(55296+(l-65536>>10),56320+(l-65536&1023)),f=s.replace(s.substr(0,6),f)},uni8inherent:function(e,a){var s=ssw.uni8(e,a);return s=a?(s=s.replace(/1DA9A/g,"")).replace(/1DAA0/g,""):(s=s.replace(/\uD836\uDE9A/g,"")).replace(/\uD836\uDEA0/g,"")},opt:function(e,a){var s,r,t,n,i=ssw.fsw(e);if(i){t=parseInt("1D800",16);var f,c="[0-9]{3}x[0-9]{3}",l=(i=(i=(i=(i=(i=(i=i.replace("B","B!")).replace("A",a?t.toString(16).toUpperCase():String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023)))).replace("B!",a?(t+1).toString(16).toUpperCase():String.fromCharCode(55296+(t+1-65536>>10),56320+(t+1-65536&1023)))).replace("L",a?(t+2).toString(16).toUpperCase():String.fromCharCode(55296+(t+2-65536>>10),56320+(t+2-65536&1023)))).replace("M",a?(t+3).toString(16).toUpperCase():String.fromCharCode(55296+(t+3-65536>>10),56320+(t+3-65536&1023)))).replace("R",a?(t+4).toString(16).toUpperCase():String.fromCharCode(55296+(t+4-65536>>10),56320+(t+4-65536&1023)))).match(new RegExp(c,"g"));for(f=0;f<l.length;f+=1)n=(n=(r=l[f]).split("x")).map(function(e){return e=120844+parseInt(e)-250,a?e.toString(16).toUpperCase():String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}),i=i.replace(r,n.join(""));var c="S[123][0-9a-f]{2}[0-5][0-9a-f]",l=i.match(new RegExp(c,"g"));for(f=0;f<l.length;f+=1)s=l[f],i=i.replace(s,ssw.uni(s,"4",a));return i}s=ssw.key(e);var p=ssw.uni(s,"4",a),c="[0-9]{3}x[0-9]{3}";return(l=p.match(new RegExp(c,"g")))&&(n=(n=(r=l[0]).split("x")).map(function(e){return e=120844+parseInt(e)-250,a?e.toString(16).toUpperCase():String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}),p=p.replace(r,n.join(""))),p},unicode:function(e,a){var s,r=ssw.fsw(e);if(r){var t,n,i;n=parseInt("1DABA",16);var f,c="[0-9]{3}x[0-9]{3}",l=(r=(r=(r=(r=(r=(r=r.replace("B","B!")).replace("A",a?n.toString(16).toUpperCase():String.fromCharCode(55296+(n-65536>>10),56320+(n-65536&1023)))).replace("B!",a?(n+1).toString(16).toUpperCase():String.fromCharCode(55296+(n+1-65536>>10),56320+(n+1-65536&1023)))).replace("L",a?(n+2).toString(16).toUpperCase():String.fromCharCode(55296+(n+2-65536>>10),56320+(n+2-65536&1023)))).replace("M",a?(n+3).toString(16).toUpperCase():String.fromCharCode(55296+(n+3-65536>>10),56320+(n+3-65536&1023)))).replace("R",a?(n+4).toString(16).toUpperCase():String.fromCharCode(55296+(n+4-65536>>10),56320+(n+4-65536&1023)))).match(new RegExp(c,"g"));for(f=0;f<l.length;f+=1)i=(i=(t=l[f]).replace("x","").split("")).map(function(e){return e=121520+parseInt(e),a?e.toString(16).toUpperCase():String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}),r=r.replace(t,i.join(""));c="S[123][0-9a-f]{2}[0-5][0-9a-f]";var p=(l=r.match(new RegExp(c,"g")))?l.length:0;for(f=0;f<p;f+=1)s=l[f],r=r.replace(s,ssw.uni8(s,a));return r}s=ssw.key(e);var o=ssw.uni8(s,a),c="[0-9]{3}x[0-9]{3}";return(l=o.match(new RegExp(c,"g"))).length&&(i=(i=l[0].replace("x","").split("")).map(function(e){return e=121520+parseInt(e),a?e.toString(16).toUpperCase():String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}),o=o.replace(l[0],i.join(""))),o},bbox:function(e){var a,s,r,t,n,i,f=/[0-9]{3}x[0-9]{3}/g,c=e.match(f);if(c){var l;for(l=0;l<c.length;l+=1)a=parseInt(c[l].slice(0,3)),s=parseInt(c[l].slice(4,7)),0===l?(r=a,t=a,n=s,i=s):(r=Math.min(r,a),t=Math.max(t,a),n=Math.min(n,s),i=Math.max(i,s));return r==t&&n==i&&(r>500?r=1e3-r:t=1e3-t,n>500?n=1e3-n:i=1e3-i),r+" "+t+" "+n+" "+i}return""},displace:function(e,a,s){var r,t,n=e.match(new RegExp("[0-9]{3}x[0-9]{3}","g"));if(n){var i;for(i=0;i<n.length;i+=1)r=parseInt(n[i].slice(0,3))+a,t=parseInt(n[i].slice(4,7))+s,e=e.replace(n[i],r+"X"+t);e=e.replace(/X/g,"x")}return e},sizes:{},size:function(e){var a,s,r,t,n=ssw.fsw(e);if(n){var i=ssw.bbox(n),f=(i=i.split(" "))[0],c=i[1],l=i[2];return"0x0"==(t=c-f+"x"+(i[3]-l))?"":t}var p=ssw.key(e);if(!p)return"";if(ssw.sizes[p])return ssw.sizes[p];var o,g;ssw.canvaser||(ssw.canvaser=document.createElement("canvas"),ssw.canvaser.width=152,ssw.canvaser.height=152);var u=ssw.canvaser.getContext("2d");u.clearRect(0,0,152,152),u.font="60px 'SuttonSignWritingLine'",u.fillText(ssw.uni(p,"F"),0,0),o=u.getImageData(0,0,152,152).data;e:for(a=151;a>=0;a--)for(s=0;s<152;s+=1)for(r=0;r<4;r+=1)if(g=4*a+4*s*152+r,o[g])break e;var h=a;e:for(s=151;s>=0;s--)for(a=0;a<h;a+=1)for(r=0;r<4;r+=1)if(g=4*a+4*s*152+r,o[g])break e;var w=s+1;if(h=""+Math.ceil(h/2),w=""+Math.ceil(w/2),"S19559".indexOf(p)>-1&&(h="19"),"S16d03 S16d0f S16d1f S16d2f S16d23 S16d43 S16d53 S1710d S1711d S1712d S17311 S17321 S17733 S1773f S17743 S1774f S17753 S1775f S16d33 S1713d S1714d S17301 S17329 S1715d".indexOf(p)>-1&&(h="20"),"S24c15 S24c30".indexOf(p)>-1&&(h="22"),"S2903b".indexOf(p)>-1&&(h="23"),"S1d203 S1d233".indexOf(p)>-1&&(h="25"),"S24c15".indexOf(p)>-1&&(h="28"),"S2e629".indexOf(p)>-1&&(h="29"),"S23425".indexOf(p)>-1&&(h="30"),"S2d316".indexOf(p)>-1&&(h="40"),"S2541a".indexOf(p)>-1&&(h="50"),"S1732f S17731 S17741 S17751".indexOf(p)>-1&&(w="20"),"S1412c".indexOf(p)>-1&&(w="21"),"S2a903".indexOf(p)>-1&&(w="31"),"S2b002".indexOf(p)>-1&&(w="36"),"0x0"==(t=h+"x"+w)){var S="S1000815x30 S1000921x30 S1000a30x15 S1000b30x21 S1000c15x30 S1000d21x30 ",d=S.indexOf(p);if(-1==d)t="";else{var x=S.indexOf(" ",d);t=S.slice(d+6,x)}}else ssw.sizes[p]=t;return t},max:function(e,a){var s=ssw.type(a),r=s[0],t=s[1],n="S"+ssw.range(r,t,1)+"[0-5][0-9a-f][0-9]{3}x[0-9]{3}",i=e.match(new RegExp(n,"g"));if(i){var f,c,l,p,o,g="";for(o=0;o<i.length;o+=1)f=i[o].slice(0,6),c=parseInt(i[o].slice(6,9)),l=parseInt(i[o].slice(10,13)),p=ssw.size(f).split("x"),g+=f+c+"x"+l+(c+parseInt(p[0]))+"x"+(l+parseInt(p[1]));return g}return""},norm:function(e){var a,s,r,t,n=ssw.bbox(ssw.max(e,"hcenter")),i=ssw.bbox(ssw.max(e,"vcenter")),f=ssw.bbox(ssw.max(e));if(!f)return"";i?(a=parseInt(i.slice(0,3)),s=parseInt(i.slice(4,7))):(a=parseInt(f.slice(0,3)),s=parseInt(f.slice(4,7))),n?(r=parseInt(n.slice(8,11)),t=parseInt(n.slice(12,15))):(r=parseInt(f.slice(8,11)),t=parseInt(f.slice(12,15)));var c=500-parseInt((a+s)/2),l=500-parseInt((r+t)/2),p=e.match(/(A(S[123][0-9a-f]{2}[0-5][0-9a-f])+)?[BLMR]/);return p=p?p[0]:"M",e=p+parseInt(f.slice(4,7))+"x"+parseInt(f.slice(12,15))+ssw.filter(e),ssw.displace(e,c,l)},svg:function(e,a){var s,r,t,n,i,f,c=ssw.fsw(e,!0),l=ssw.styling(c);if(!c){var p=ssw.key(e);if(!(t=ssw.size(p)))return"";c=6==p.length?p+"500x500":p}if(a||(a={}),a.size?a.size=parseFloat(a.size)||"x":a.size=1,a.colorize?a.colorize=!0:a.colorize=!1,a.pad?a.pad=parseInt(a.pad):a.pad=0,a.line?a.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(a.line)?"#"+a.line:a.line:a.line="black",a.fill?a.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(a.fill)?"#"+a.fill:a.fill:a.fill="white",a.back?a.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(a.back)?"#"+a.back:a.back:a.back="",a.E=[],a.F=[],a.copy=a.copy||"fsw",l){var o;if(s=l.split("-"),o=s[1].match(/C/),a.colorize=!!o,(o=s[1].match(/P[0-9]{2}/))&&(a.pad=parseInt(o[0].substring(1,o[0].length))),o=s[1].match(/G_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)_/)){var g=o[0].substring(2,o[0].length-1);a.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(g)?"#"+g:g}if((o=s[1].match(/D_([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+))?_/))&&((n=o[0].substring(2,o[0].length-1).split(","))[0]&&(a.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(n[0])?"#"+n[0]:n[0]),n[1]&&(a.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(n[1])?"#"+n[1]:n[1])),(o=s[1].match(/Z([0-9]+(\.[0-9]+)?|x)/))&&(a.size=parseFloat(o[0].substring(1,o[0].length))||"x"),s[2]||(s[2]=""),o=s[2].match(/D[0-9]{2}_([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+))?_/g))for(i=0;i<o.length;i+=1)r=parseInt(o[i].substring(1,3)),(n=o[i].substring(4,o[i].length-1).split(","))[0]&&(n[0]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(n[0])?"#"+n[0]:n[0]),n[1]&&(n[1]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(n[1])?"#"+n[1]:n[1]),a.E[r]=n;if(o=s[2].match(/Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?/g))for(i=0;i<o.length;i+=1)r=parseInt(o[i].substring(1,3)),(f=o[i].substring(4,o[i].length).split(","))[0]=parseFloat(f[0]),a.F[r]=f;s.length>3&&(s=s.slice(3).join("-").split("!"),a.class=s[0]?s[0]:"",a.id=s[1]?s[1]:"")}var u,h,w,S=/S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,d={};d.L=-1,d.R=1;var x,b,I,m,v,k,A=500,F=500,z=500,C=500;I=c.charAt(0);var y=ssw.bbox(c);y=y.split(" "),A=parseInt(y[0]),F=parseInt(y[1]),z=parseInt(y[2]),C=parseInt(y[3]),"S"==I&&(500==A&&500==z?(f=t.split("x"),F=500+parseInt(f[0]),C=500+parseInt(f[1])):(F=1e3-A,C=1e3-z)),(h=c.match(S))||(h=[]);var E;for(i=0;i<h.length;i+=1)u=h[i].slice(0,6),x=h[i].slice(6,9),b=h[i].slice(10,13),a.F[i+1]&&(a.F[i+1][1]&&(x=parseInt(x)+parseInt(a.F[i+1][1].slice(0,3))-500,b=parseInt(b)+parseInt(a.F[i+1][1].slice(4,7))-500,A=Math.min(A,x),z=Math.min(z,b)),(E=ssw.size(u))&&(E=E.split("x"),F=Math.max(F,parseInt(x)+a.F[i+1][0]*parseInt(E[0])),C=Math.max(C,parseInt(b)+a.F[i+1][0]*parseInt(E[1])))),w='<g transform="translate('+x+","+(b=parseInt(b))+')">',w+="<text ",w+='class="sym-fill" ',a.css||(w+="style=\"pointer-events:none;font-family:'SuttonSignWritingFill';font-size:"+(a.F[i+1]?30*a.F[i+1][0]:30)+"px;fill:"+(a.E[i+1]&&a.E[i+1][1]?a.E[i+1][1]:a.fill)+";",w+='"'),w+=">",w+=ssw.uni(u,"10"),w+="</text>",w+="<text ",w+='class="sym-line" ',a.css||(w+='style="pointer-events:none;',w+="font-family:'SuttonSignWritingLine';font-size:"+(a.F[i+1]?30*a.F[i+1][0]:30)+"px;fill:"+(a.E[i+1]?a.E[i+1][0]:a.colorize?"#"+ssw.colorize(u):a.line)+";",w+='"'),w+=">",w+=ssw.uni(u,"F"),w+="</text>",w+="</g>",h[i]=w;A-=a.pad,F+=a.pad,z-=a.pad,m=F-A,v=(C+=a.pad)-z,k=75*(k=d[I]||0)+A-400;var R="<svg ";switch(a.class&&(R+='class="'+a.class+'" '),a.id&&(R+='id="'+a.id+'" '),R+='version="1.1" xmlns="http://www.w3.org/2000/svg" ',"x"!=a.size&&(R+='width="'+m*a.size+'" height="'+v*a.size+'" '),R+='viewBox="'+A+" "+z+" "+m+" "+v+'">',R+='<text style="font-size:0%;">',a.copy){case"uni8":R+=ssw.uni8(e);break;case"code":R+=ssw.code(e);break;case"opt":R+=ssw.opt(e);break;case"unicode":R+=ssw.unicode(e);break;default:R+=e}return R+="</text>",a.back&&(R+='  <rect x="'+A+'" y="'+z+'" width="'+m+'" height="'+v+'" style="fill:'+a.back+';" />'),R+=h.join("")+"</svg>",a.laned&&(R='<div style="padding:10px;position:relative;width:'+m+"px;height:"+v+"px;left:"+k+'px;">'+R+"</div>"),R},canvas:function(e,a){var s,r,t,n,i,f,c,l=document.createElement("canvas"),p=ssw.fsw(e,!0),o=ssw.styling(p);if(!p){var g=ssw.key(e);if(t=ssw.size(g),!g)return"";p=6==g.length?g+"500x500":g}if(a||(a={}),a.size?a.size=parseFloat(a.size):a.size=1,a.colorize?a.colorize=!0:a.colorize=!1,a.pad?a.pad=parseInt(a.pad):a.pad=0,a.line?a.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(a.line)?"#"+a.line:a.line:a.line="black",a.fill?a.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(a.fill)?"#"+a.fill:a.fill:a.fill="white",a.back?a.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(a.back)?"#"+a.back:a.back:a.back="",a.E=[],a.F=[],o){var u;if(s=o.split("-"),u=s[1].match(/C/),a.colorize=!!u,(u=s[1].match(/P[0-9]{2}/))&&(a.pad=parseInt(u[0].substring(1,u[0].length))),u=s[1].match(/G_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)_/)){var h=u[0].substring(2,u[0].length-1);a.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(h)?"#"+h:h}if((u=s[1].match(/D_([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+))?_/))&&((r=u[0].substring(2,u[0].length-1).split(","))[0]&&(a.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(r[0])?"#"+r[0]:r[0]),r[1]&&(a.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(r[1])?"#"+r[1]:r[1])),(u=s[1].match(/Z[0-9]+(\.[0-9]+)?/))&&(a.size=u[0].substring(1,u[0].length)),s[2]||(s[2]=""),u=s[2].match(/D[0-9]{2}_([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+))?_/g))for(f=0;f<u.length;f+=1)c=parseInt(u[f].substring(1,3)),(r=u[f].substring(4,u[f].length-1).split(","))[0]&&(r[0]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(r[0])?"#"+r[0]:r[0]),r[1]&&(r[1]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(r[1])?"#"+r[1]:r[1]),a.E[c]=r;if(u=s[2].match(/Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?/g))for(f=0;f<u.length;f+=1)c=parseInt(u[f].substring(1,3)),(i=u[f].substring(4,u[f].length).split(","))[0]=parseFloat(i[0]),a.F[c]=i}var w,S,d=/S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,x={};x.L=-1,x.R=1;var b,I,m,v,k,A=500,F=500,z=500,C=500;m=p.charAt(0);var y=ssw.bbox(p);y=y.split(" "),A=parseInt(y[0]),F=parseInt(y[1]),z=parseInt(y[2]),C=parseInt(y[3]),"S"==m&&(500==A&&500==z?(i=t.split("x"),F=500+parseInt(i[0]),C=500+parseInt(i[1])):(F=1e3-A,C=1e3-z));var E=(S=p.match(d))?S.length:0;for(f=0;f<E;f+=1)w=S[f].slice(0,6),b=S[f].slice(6,9),I=S[f].slice(10,13),a.F[f+1]&&(a.F[f+1][1]&&(b=parseInt(b)+parseInt(a.F[f+1][1].slice(0,3))-500,I=parseInt(I)+parseInt(a.F[f+1][1].slice(4,7))-500,A=Math.min(A,b),z=Math.min(z,I)),(n=ssw.size(w))&&(n=n.split("x"),F=Math.max(F,parseInt(b)+a.F[f+1][0]*parseInt(n[0])),C=Math.max(C,parseInt(I)+a.F[f+1][0]*parseInt(n[1]))));A-=a.pad,F+=a.pad,z-=a.pad,C+=a.pad,v=(F-A)*a.size,k=(C-z)*a.size,l.width=v||1,l.height=k||1;var R=l.getContext("2d");for(a.back&&(R.rect(0,0,v,k),R.fillStyle=a.back,R.fill()),S=p.match(d),f=0;f<E;f+=1)w=S[f].slice(0,6),b=S[f].slice(6,9),I=S[f].slice(10,13),a.F[f+1]&&(a.F[f+1][1]&&(b=parseInt(b)+parseInt(a.F[f+1][1].slice(0,3))-500,I=parseInt(I)+parseInt(a.F[f+1][1].slice(4,7))-500,A=Math.min(A,b),z=Math.min(z,I)),(n=ssw.size(w))&&(n=n.split("x"),F=Math.max(F,parseInt(b)+a.F[f+1][0]*parseInt(n[0])),C=Math.max(C,parseInt(I)+a.F[f+1][0]*parseInt(n[1])))),R.font=(a.F[f+1]?30*a.size*a.F[f+1][0]:30*a.size)+"px 'SuttonSignWritingFill'",R.fillStyle=a.E[f+1]&&a.E[f+1][1]?a.E[f+1][1]:a.fill,R.fillText(ssw.uni(w,"10"),(b-A)*a.size,(I-z)*a.size),R.font=(a.F[f+1]?30*a.size*a.F[f+1][0]:30*a.size)+"px 'SuttonSignWritingLine'",R.fillStyle=a.E[f+1]?a.E[f+1][0]:a.colorize?"#"+ssw.colorize(w):a.line,R.fillText(ssw.uni(w,"F"),(b-A)*a.size,(I-z)*a.size);return l},png:function(e,a){if(ssw.fsw(e,!0)||ssw.key(e,!0)){var s=ssw.canvas(e,a),r=s.toDataURL("image/png");return s.remove(),r}return""},query:function(e){return"-"==e?"-":(e=e.match(/Q((A(S[123][0-9a-f]{2}[0-5u][0-9a-fu]|R[123][0-9a-f]{2}t[123][0-9a-f]{2})+)?T)?((R[123][0-9a-f]{2}t[123][0-9a-f]{2}([0-9]{3}x[0-9]{3})?)|(S[123][0-9a-f]{2}[0-5u][0-9a-fu]([0-9]{3}x[0-9]{3})?))*(V[0-9]+)?-?/))?e[0]:""},range:function(e,a,s){var r,t,n,i,f,c,l;if(s||(s=""),e=("000"+e).slice(-3),a=""+a,r="",e===a)return e;if(t=[],(e[0]!=a[0]||e[1]!=a[1])&&"0"!=e[2])if(r=e[0]+e[1],s){switch(e[2]){case"f":r+="f";break;case"e":r+="[ef]";break;case"d":case"c":case"b":case"a":r+="["+e[2]+"-f]";break;default:switch(e[2]){case"9":r+="[9a-f]";break;case"8":r+="[89a-f]";break;default:r+="["+e[2]+"-9a-f]"}}n=15-parseInt(e[2],16)+1,e=""+(parseInt(e,16)+n).toString(16),t.push(r)}else{switch(e[2]){case"9":r+="9";break;case"8":r+="[89]";break;default:r+="["+e[2]+"-9]"}e=""+(1*e+(n=9-e[2]+1)),t.push(r)}if(r="",e[0]!=a[0]&&"0"!=e[1])if(s){switch(r=e[0],e[1]){case"f":r+="f";break;case"e":r+="[ef]";break;case"d":case"c":case"b":case"a":r+="["+e[1]+"-f]";break;case"9":r+="[9a-f]";break;case"8":r+="[89a-f]";break;default:r+="["+e[1]+"-9a-f]"}r+="[0-9a-f]",n=15-parseInt(e[1],16)+1,e=""+(parseInt(e,16)+16*n).toString(16),t.push(r)}else{switch(r=e[0],n=9-e[1]+1,e[1]){case"9":r+="9";break;case"8":r+="[89]";break;default:r+="["+e[1]+"-9]"}r+="[0-9]",e=""+(1*e+10*(n=9-e[1]+1)),t.push(r)}if(r="",e[0]!=a[0])if(s){switch(n=parseInt(a[0],16)-parseInt(e[0],16),i=(parseInt(e[0],16)+n-1).toString(16),n){case 1:r=e[0];break;case 2:r="["+e[0]+i+"]";break;default:switch(c=parseInt(e[0],16)>9?"h":"d",l=parseInt(i,16)>9?"h":"d",c+l){case"dd":r+="["+e[0]+"-"+i+"]";break;case"dh":switch(n=9-e[0]){case 0:r+="[9";break;case 1:r+="[89";break;default:r+="["+e[0]+"-9"}switch(i[0]){case"a":r+="a]";break;case"b":r+="ab]";break;default:r+="a-"+i+"]"}break;case"hh":r+="["+e[0]+"-"+i+"]"}}r+="[0-9a-f][0-9a-f]",n=parseInt(a[0],16)-parseInt(e[0],16),e=""+(parseInt(e,16)+256*n).toString(16),t.push(r)}else{switch(n=a[0]-e[0],i=1*e[0]+n-1,n){case 1:r=e[0];break;case 2:r="["+e[0]+i+"]";break;default:r="["+e[0]+"-"+i+"]"}r+="[0-9][0-9]",e=""+(1*e+100*n),t.push(r)}if(r="",e[1]!=a[1])if(s){switch(n=parseInt(a[1],16)-parseInt(e[1],16),i=(parseInt(e[1],16)+n-1).toString(16),r=e[0],n){case 1:r+=e[1];break;case 2:r+="["+e[1]+i+"]";break;default:switch(c=parseInt(e[1],16)>9?"h":"d",l=parseInt(i,16)>9?"h":"d",c+l){case"dd":r+="["+e[1],n>1&&(r+="-"),r+=i+"]";break;case"dh":switch(n=9-e[1]){case 0:r+="[9";break;case 1:r+="[89";break;default:r+="["+e[1]+"-9"}switch(a[1]){case"a":r+="]";break;case"b":r+="a]";break;default:r+="a-"+(parseInt(a[1],16)-1).toString(16)+"]"}break;case"hh":r+="["+e[1],n>1&&(r+="-"),r+=(parseInt(a[1],16)-1).toString(16)+"]"}}r+="[0-9a-f]",n=parseInt(a[1],16)-parseInt(e[1],16),e=""+(parseInt(e,16)+16*n).toString(16),t.push(r)}else{switch(n=a[1]-e[1],i=1*e[1]+n-1,r=e[0],n){case 1:r+=e[1];break;case 2:r+="["+e[1]+i+"]";break;default:r+="["+e[1]+"-"+i+"]"}r+="[0-9]",e=""+(1*e+10*n),t.push(r)}if(r="",e[2]!=a[2])if(s){switch(r=e[0]+e[1],n=parseInt(a[2],16)-parseInt(e[2],16),c=parseInt(e[2],16)>9?"h":"d",l=parseInt(a[2],16)>9?"h":"d",c+l){case"dd":r+="["+e[2],n>1&&(r+="-"),r+=a[2]+"]";break;case"dh":switch(n=9-e[2]){case 0:r+="[9";break;case 1:r+="[89";break;default:r+="["+e[2]+"-9"}switch(a[2]){case"a":r+="a]";break;case"b":r+="ab]";break;default:r+="a-"+a[2]+"]"}break;case"hh":r+="["+e[2],n>1&&(r+="-"),r+=a[2]+"]"}n=parseInt(a[2],16)-parseInt(e[2],16),e=""+(parseInt(e,16)+n).toString(16),t.push(r)}else{switch(n=a[2]-e[2],r=e[0]+e[1],n){case 0:r+=e[2];break;case 1:r+="["+e[2]+a[2]+"]";break;default:r+="["+e[2]+"-"+a[2]+"]"}e=""+(1*e+n),t.push(r)}return r="","0"==e[2]&&"0"==a[2]&&(r=a,t.push(r)),r="",f=t.length,r=1==f?t[0]:"(("+(r=t.join(")|("))+"))"},regex:function(e,a){if(!(e=ssw.query(e)))return"";var s,r,t,n,i,f,c,l,p,o,g;a||(a=20);var u,h="S[123][0-9a-f]{2}[0-5][0-9a-f]",w="[0-9]{3}x[0-9]{3}",S="[BLMR]("+w+")("+h+w+")*",d="(A("+h+")+)",x="R[123][0-9a-f]{2}t[123][0-9a-f]{2}",b="S[123][0-9a-f]{2}[0-5u][0-9a-fu]",I="-C?(P[0-9]{2})?(G_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)_)?(D_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)(,([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+))?_)?(Z([0-9]+(.[0-9]+)?|x))?(-(D[0-9]{2}_([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)(,([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+))?_)*(Z[0-9]{2},[0-9]+(.[0-9]+)?(,[0-9]{3}x[0-9]{3})?)*)?(--?[_a-zA-Z][_a-zA-Z0-9-]{0,100}( -?[_a-zA-Z][_a-zA-Z0-9-]{0,100})*!([a-zA-Z][_a-zA-Z0-9-]{0,100}!)?)?",m="("+I+")?";if(!(e=ssw.query(e)))return"";if("-"==e)return[I];if("Q"==e)return[d+"?"+S];if("Q-"==e)return[d+"?"+S+m];if("QT"==e)return[d+S];if("QT-"==e)return[d+S+m];var v=[],k=e.indexOf("T")+1;if(k){u="(A";var A=e.slice(0,k);if(e=e.replace(A,""),"QT"==A)u+="("+h+")+)";else if(s=A.match(new RegExp("("+b+"|"+x+")","g"))){var F;for(r=0;r<s.length;r+=1)(F=s[r].match(new RegExp(b)))?(c=F[0].slice(0,4),c+="u"==(o=F[0].slice(4,5))?"[0-5]":o,u+=c+="u"==(g=F[0].slice(5,6))?"[0-9a-f]":g):(i=s[r].slice(1,4),f=s[r].slice(5,8),u+=c="S"+ssw.range(i,f,"hex")+"[0-5][0-9a-f]");u+="("+h+")*)"}}if((s=e.match(new RegExp("(V[0-9]+)","g")))&&(a=1*s.toString().slice(1)),t=b+"([0-9]{3}x[0-9]{3})?",s=e.match(new RegExp(t,"g")))for(r=0;r<s.length;r+=1)c="S"+(n=s[r].toString()).slice(1,4),c+="u"==(o=n.slice(4,5))?"[0-5]":o,c+="u"==(g=n.slice(5,6))?"[0-9a-f]":g,n.length>6?(l=1*n.slice(6,9),p=1*n.slice(10,13),c+=ssw.range(l-a,l+a),c+="x",c+=ssw.range(p-a,p+a)):c+=w,c=S+c+"("+h+w+")*",c=k?u+c:d+"?"+c,e.indexOf("-")>0&&(c+=m),v.push(c);if(t=x+"([0-9]{3}x[0-9]{3})?",s=e.match(new RegExp(t,"g")))for(r=0;r<s.length;r+=1)i=(n=s[r].toString()).slice(1,4),f=n.slice(5,8),c="S"+ssw.range(i,f,"hex")+"[0-5][0-9a-f]",n.length>8?(l=1*n.slice(8,11),p=1*n.slice(12,15),c+=ssw.range(l-a,l+a),c+="x",c+=ssw.range(p-a,p+a)):c+=w,c=S+c+"("+h+w+")*",c=k?u+c:d+"?"+c,e.indexOf("-")>0&&(c+=m),v.push(c);return v.length||(e.indexOf("-")>0&&(c+=m),v.push(u+S)),v},results:function(e,a,s){if(!a)return[];(-1==="BLMR".indexOf(s)||s.length>1)&&(s="");var r,t,n,i,f=ssw.regex(e);if(!f)return[];var c;for(c=0;c<f.length;c+=1)r=f[c],a=(t=a.match(new RegExp(r,"g")))?t.join(" "):"";return a?(s&&(a=(a=(a=(a=a.replace(/B/g,s)).replace(/L/g,s)).replace(/M/g,s)).replace(/R/g,s)),i=(n=a.split(" ")).filter(function(e){return!(e in n)&&(n[e]=!0)},{})):i=[],i},lines:function(e,a,s){if(!a)return[];(-1==="BLMR".indexOf(s)||s.length>1)&&(s="");var r,t,n,i,f=ssw.regex(e);if(!f)return[];var c;for(c=0;c<f.length;c+=1)r="^"+(r=f[c])+".*",a=(t=a.match(new RegExp(r,"mg")))?t.join("\n"):"";return a?(s&&(a=(a=(a=(a=a.replace(/B/g,s)).replace(/L/g,s)).replace(/M/g,s)).replace(/R/g,s)),i=(n=a.split("\n")).filter(function(e){return!(e in n)&&(n[e]=!0)},{})):i=[],i},convert:function(e,a){var s,r="";if(ssw.fsw(e)&&/^[Aa]?([Ss]L?)?$/.test(a)){var t,n,i="S[123][0-9a-f]{2}[0-5][0-9a-f]";if((a.indexOf("A")>-1||a.indexOf("a")>-1)&&(t=e.match(new RegExp("A("+i+")*","g"))))if(n=t[0],a.indexOf("A")>-1)r+=n+"T";else{for(t=n.match(new RegExp("S[123][0-9a-f]{2}","g")),r+="A",s=0;s<t.length;s+=1)r+=t[s]+"uu";r+="T"}if((a.indexOf("S")>-1||a.indexOf("s")>-1)&&(t=e.match(new RegExp(i+"[0-9]{3}x[0-9]{3}","g"))))for(s=0;s<t.length;s+=1)a.indexOf("S")>-1?r+=t[s].slice(0,6):r+=t[s].slice(0,4)+"uu",a.indexOf("L")>-1&&(r+=t[s].slice(6,13))}return r?"Q"+r:""},signtext:function(e){var a=ssw.regex("Q");a="("+(a=a[0])+"|S3[0-9a-f]{2}[0-5][0-9a-f]([0-9]{3}x[0-9]{3}))("+ssw.regex("-")[0]+")?";var s=e.match(new RegExp(a,"mg"));return s||[]},paragraph:function(e){return'<span class="outside"><span class="middle"><span class="inside">'+ssw.signtext(e).map(function(e){var a=e.match(/Z([0-9]+(\.[0-9]+)?)/);a=a?parseFloat(a[1]):1;var s=ssw.bbox(e).split(" "),r=(s[1]-s[0])*a,t=(s[3]-s[2])*a,n=(1e3-s[0]-s[1])*a;n+=2,e.indexOf("L")>-1&&(n+=150),e.indexOf("R")>-1&&(n-=150);var i="width: "+r+"px;height: "+t+"px;";return n>0?i+="margin-right: "+n+"px;":n<0&&(i+="border-left: "+(n=-n)+"px solid transparent;"),'<div class="sign" style="'+i+'">'+ssw.svg(e)+"</div>"}).join("")+"</span></span></span>"}};

